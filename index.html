<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bayerisches Schafkopf</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="header">
        <h1>üÉè Bayerisches Schafkopf</h1>
        <div class="game-info">
            <div>Spiel: <span id="game-type">Rufspiel</span></div>
            <div>Runde: <span id="round-counter">1</span></div>
            <div>Stiche: <span id="trick-counter">0/8</span></div>
            <div>Trumpf: Herz</div>
            <div>Gerufenes Ass: <span id="called-ace">-</span></div>
        </div>
    </div>

    <div class="game-area">
        <div class="players">
            <!-- CPU-Spieler 1 (links) -->
            <div class="player cpu1" id="player-1">
                <h3>Anna</h3>
                <div class="player-info">
                    <div>Punkte: <span class="points">0</span></div>
                    <div>Stiche: <span class="tricks">0</span></div>
                </div>
                <div class="cards" id="cards-1"></div>
            </div>

            <!-- CPU-Spieler 2 (oben) -->
            <div class="player cpu2" id="player-2">
                <h3>Hans</h3>
                <div class="player-info">
                    <div>Punkte: <span class="points">0</span></div>
                    <div>Stiche: <span class="tricks">0</span></div>
                </div>
                <div class="cards" id="cards-2"></div>
            </div>

            <!-- CPU-Spieler 3 (rechts) -->
            <div class="player cpu3" id="player-3">
                <h3>Sepp</h3>
                <div class="player-info">
                    <div>Punkte: <span class="points">0</span></div>
                    <div>Stiche: <span class="tricks">0</span></div>
                </div>
                <div class="cards" id="cards-3"></div>
            </div>

            <!-- Menschlicher Spieler (unten) -->
            <div class="player human active" id="player-0">
                <h3>Sie</h3>
                <div class="player-info">
                    <div>Punkte: <span class="points">0</span></div>
                    <div>Stiche: <span class="tricks">0</span></div>
                </div>
                <div class="cards" id="cards-0"></div>
            </div>

            <!-- Spielfeld-Mitte -->
            <div class="center-area">
                <div class="game-status" id="game-status">
                    Neues Spiel - Karten werden verteilt...
                </div>
                
                <div class="trick-area" id="trick-area">
                    <!-- Hier werden die gespielten Karten angezeigt -->
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn" onclick="newGame()">Neues Spiel</button>
            <button class="btn" onclick="showRules()">Regeln</button>
            <button class="btn" onclick="showStats()">Statistik</button>
            <button class="btn" onclick="toggleDebugMode()" id="debug-btn">Debug: AN</button>
            <button class="btn" onclick="toggleCardImages()" id="card-images-btn">Kartensymbole</button>
        </div>
    </div>

    <!-- Modal f√ºr Dialoge -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <h2 id="modal-title">Titel</h2>
            <p id="modal-text">Text</p>
            <button class="btn" onclick="closeModal()">OK</button>
        </div>
    </div>

    <!-- AI-SYSTEM INTEGRATION -->
    <script type="module">
        // AI-Module laden und global verf√ºgbar machen
        async function initializeAISystem() {
            try {
                console.log('ü§ñ Lade Q-Learning AI-System...');
                
                // AI-Module importieren
                await import('./js/ai/ai-testing.js');
                await import('./js/ai/ai-bridge.js');
                await import('./js/ai/ai-migration.js');
                await import('./js/ai/human-feedback.js');
                
                console.log('‚úÖ AI-Module erfolgreich geladen!');
                console.log('üìù Verf√ºgbare Commands:');
                console.log('   runAITests() - Vollst√§ndige Test-Suite');
                console.log('   aiQuickTest() - Schnell-Test');
                console.log('   aiDebug() - AI-Status anzeigen');
                console.log('   aiStats() - Performance-Statistiken');
                console.log('   migrateToNewAI() - Auf Q-Learning umstellen');
                console.log('   enableABTesting() - A/B Testing aktivieren');
                console.log('   aiPerformanceBenchmark() - Performance-Tests');
                console.log('   üßë‚Äçüè´ enableHumanTraining() - Human-in-the-Loop Learning');
                console.log('   getHumanFeedbackStats() - Feedback-Statistiken');
                
                // Auto-Test wenn URL-Parameter vorhanden
                if (window.location.search.includes('aitest=true')) {
                    console.log('üß™ Auto-Test gestartet...');
                    setTimeout(() => {
                        if (window.runAITests) {
                            window.runAITests();
                        }
                    }, 2000);
                }
                
            } catch (error) {
                console.error('‚ùå Fehler beim Laden der AI-Module:', error);
                console.log('üîÑ Lade Browser-AI Fallback...');
                
                // Fallback: Browser-AI laden
                const script = document.createElement('script');
                script.src = './js/ai/browser-ai.js';
                script.onload = () => {
                    console.log('‚úÖ Browser-AI Fallback geladen!');
                    // Auto-Test auch f√ºr Browser-AI
                    if (window.location.search.includes('aitest=true')) {
                        setTimeout(() => {
                            if (window.runAITests) {
                                window.runAITests();
                            }
                        }, 1000);
                    }
                };
                script.onerror = () => {
                    console.error('‚ùå Browser-AI Fallback konnte nicht geladen werden');
                    console.log('üîÑ Verwende nur Legacy-Bots');
                };
                document.head.appendChild(script);
            }
        }
        
        // AI-System nach dem Laden der Seite initialisieren
        window.addEventListener('load', () => {
            setTimeout(initializeAISystem, 1000);
        });
        
    </script>
    
    <!-- LEGACY SYSTEM (Fallback) -->
    <script src="js/cards.js"></script>
    <script src="js/game-state.js"></script>
    <script src="js/player.js"></script>
    <script src="js/rules.js"></script>
    <script src="js/strategic-bots.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/game.js"></script>
    
    <!-- Status-Info und Spiel-Bereitschaft -->
    <script>
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('üéØ Bayerisches Schafkopf - Status:');
                console.log('   ‚úÖ Legacy-Module geladen und funktionsf√§hig');
                console.log('   ü§ñ Q-Learning AI-System wird geladen...');
                console.log('   üéÆ Spiel vollst√§ndig spielbar');
                
                if (typeof newGame === 'function') {
                    console.log('   ‚úÖ newGame() verf√ºgbar - Spiel bereit!');
                    console.log('');
                    console.log('üéÜ Probiere die AI-Commands in 2-3 Sekunden aus!');
                } else {
                    console.error('   ‚ùå newGame() nicht verf√ºgbar');
                }
            }, 500);
        });
    </script>
</body>
</html>
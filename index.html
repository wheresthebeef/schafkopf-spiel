<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bayerisches Schafkopf</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="header">
        <h1>üÉè Bayerisches Schafkopf</h1>
        <div class="game-info">
            <div>Spiel: <span id="game-type">Rufspiel</span></div>
            <div>Runde: <span id="round-counter">1</span></div>
            <div>Stiche: <span id="trick-counter">0/8</span></div>
            <div>Trumpf: Herz</div>
            <div>Gerufenes Ass: <span id="called-ace">-</span></div>
        </div>
    </div>

    <div class="game-area">
        <div class="players">
            <!-- CPU-Spieler 1 (links) -->
            <div class="player cpu1" id="player-1">
                <h3>Anna</h3>
                <div class="player-info">
                    <div>Punkte: <span class="points">0</span></div>
                    <div>Stiche: <span class="tricks">0</span></div>
                </div>
                <div class="cards" id="cards-1"></div>
            </div>

            <!-- CPU-Spieler 2 (oben) -->
            <div class="player cpu2" id="player-2">
                <h3>Hans</h3>
                <div class="player-info">
                    <div>Punkte: <span class="points">0</span></div>
                    <div>Stiche: <span class="tricks">0</span></div>
                </div>
                <div class="cards" id="cards-2"></div>
            </div>

            <!-- CPU-Spieler 3 (rechts) -->
            <div class="player cpu3" id="player-3">
                <h3>Sepp</h3>
                <div class="player-info">
                    <div>Punkte: <span class="points">0</span></div>
                    <div>Stiche: <span class="tricks">0</span></div>
                </div>
                <div class="cards" id="cards-3"></div>
            </div>

            <!-- Menschlicher Spieler (unten) -->
            <div class="player human active" id="player-0">
                <h3>Sie</h3>
                <div class="player-info">
                    <div>Punkte: <span class="points">0</span></div>
                    <div>Stiche: <span class="tricks">0</span></div>
                </div>
                <div class="cards" id="cards-0"></div>
            </div>

            <!-- Spielfeld-Mitte -->
            <div class="center-area">
                <div class="game-status" id="game-status">
                    Neues Spiel - Karten werden verteilt...
                </div>
                
                <div class="trick-area" id="trick-area">
                    <!-- Hier werden die gespielten Karten angezeigt -->
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn" onclick="newGame()">Neues Spiel</button>
            <button class="btn" onclick="showRules()">Regeln</button>
            <button class="btn" onclick="showStats()">Statistik</button>
            <button class="btn" onclick="toggleDebugMode()" id="debug-btn">Debug: AN</button>
            <button class="btn" onclick="toggleCardImages()" id="card-images-btn">Kartensymbole</button>
        </div>
    </div>

    <!-- Modal f√ºr Dialoge -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <h2 id="modal-title">Titel</h2>
            <p id="modal-text">Text</p>
            <button class="btn" onclick="closeModal()">OK</button>
        </div>
    </div>

    <!-- üöÄ REFACTORING SYSTEM LOADER -->
    <script type="module">
        // Check for ES6 module support
        window.schafkopfSystem = {
            modernBrowser: true,
            moduleSupport: true,
            loadingPhase: 'modern'
        };
        
        console.log('üÜï Modern ES6-Module Browser detected');
        console.log('üèóÔ∏è Refactoring System: Phase 1 Active');
        
        // Load modern system when ready
        setTimeout(async () => {
            try {
                // Prepare for modern module loading
                console.log('üì¶ Preparing ES6 module system...');
                
                // Note: main.js will be created in next phase
                // For now, run compatibility checks
                window.schafkopfSystem.readyForModernModules = true;
                console.log('‚úÖ Ready for Phase 2: Module Migration');
            } catch (error) {
                console.warn('‚ö†Ô∏è ES6 module issue:', error);
                window.schafkopfSystem.fallbackToLegacy = true;
            }
        }, 1000);
    </script>

    <!-- üéÆ POST-GAME AI TRAINING (Working Module) -->
    <script type="module">
        try {
            // Import working post-game training system
            const { default: postGameTraining } = await import('./js/ai/post-game-training.js');
            
            // Initialize after legacy system loads
            setTimeout(() => {
                console.log('ü§ñ Post-Game AI Training System loaded');
                console.log('üìù Use: enableHumanTraining()');
                console.log('üéØ Test: postGameTraining.demoGame()');
                
                // Show hint
                const hint = document.createElement('div');
                hint.style.cssText = 'position:fixed;bottom:20px;right:20px;background:#17a2b8;color:white;padding:8px 12px;border-radius:4px;z-index:1000;font-size:11px;cursor:pointer;';
                hint.innerHTML = 'üéÆ AI Training Ready<br><small>enableHumanTraining()</small>';
                hint.onclick = () => hint.remove();
                document.body.appendChild(hint);
                
                setTimeout(() => hint.remove(), 6000);
            }, 2000);
        } catch (error) {
            console.warn('‚ö†Ô∏è AI Training module failed:', error);
        }
    </script>
    
    <!-- üîÑ LEGACY SYSTEM (Active during transition) -->
    <script src="js/cards.js"></script>
    <script src="js/game-state.js"></script>
    <script src="js/player.js"></script>
    <script src="js/rules.js"></script>
    <script src="js/strategic-bots.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/game.js"></script>
    
    <!-- üìä System Status & Ready Notification -->
    <script>
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('\nüéØ Bayerisches Schafkopf - Refactoring Status:');
                console.log('üìä Phase 1: Setup & Structure');
                console.log('   ‚úÖ ES6 module detection active');
                console.log('   ‚úÖ Legacy system functional');
                console.log('   ‚úÖ Directory structure created');
                console.log('   üîÑ Ready for Phase 2: Module Migration');
                
                if (typeof newGame === 'function') {
                    console.log('   ‚úÖ Game ready: newGame() available');
                    console.log('\nüéÆ Game fully playable during refactoring!');
                } else {
                    console.error('   ‚ùå newGame() not available - legacy system issue');
                }
                
                // Mark Phase 1 complete
                window.schafkopfSystem = window.schafkopfSystem || {};
                window.schafkopfSystem.phase1Complete = true;
                
                console.log('\nüìã Next: Phase 2 - Core Module Migration');
            }, 800);
        });
    </script>
</body>
</html>